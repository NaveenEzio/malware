/*
   YARA Rule Set
   Author: yarGen Rule Generator
   Date: 2018-11-24
   Identifier: Samples
   Reference: https://github.com/Neo23x0/yarGen
*/

/* Rule Set ----------------------------------------------------------------- */

import "pe"

rule wannacry {
   meta:
      description = "Samples - file wannacry.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2018-11-24"
      hash1 = "ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa"
   strings:
      $x1 = "cmd.exe /c \"%s\"" fullword ascii
      $s2 = "MSVCP60.dll" fullword ascii
      $s3 = "taskdl.exe" fullword ascii
      $s4 = "taskse.exe" fullword ascii
      $s5 = "tasksche.exe" fullword ascii
      $s6 = "PPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDINGPADDINGXXPADDING" fullword ascii
      $s7 = "- unzip 0.15 Copyright 1998 Gilles Vollant " fullword ascii
      $s8 = "Global\\MsWinZonesCacheCounterMutexA" fullword ascii
      $s9 = "<!-- Windows Vista -->" fullword ascii
      $s10 = "icacls . /grant Everyone:F /T /C /Q" fullword ascii
      $s11 = "Inx%k:\\" fullword ascii
      $s12 = "Iw* -cv" fullword ascii
      $s13 = "taskse.exed*" fullword ascii
      $s14 = "inflate 1.1.3 Copyright 1995-1998 Mark Adler " fullword ascii
      $s15 = "FZT.HJo" fullword ascii
      $s16 = "CLL:\\u" fullword ascii
      $s17 = "grK.Mtt" fullword ascii
      $s18 = "5Aw:\\(" fullword ascii
      $s19 = "zHN.bAN" fullword ascii
      $s20 = "msg/m_portuguese.wnry" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 10000KB and
      ( pe.imphash() == "68f013d7437aa653a8a98a05807afeb1" or ( 1 of ($x*) or 4 of them ) )
}

rule _home_naveenezio_Project_Net_Binary_Samples_cerber {
   meta:
      description = "Samples - file cerber.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2018-11-24"
      hash1 = "e67834d1e8b38ec5864cfa101b140aeaba8f1900a6e269e6a94c90fcbfe56678"
   strings:
      $s1 = "777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777" ascii /* hex encoded string 'wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww' */
      $s2 = "66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666" ascii /* hex encoded string 'ffffffffffffffffffffffffffffffffffffffffffffffffffff' */
      $s3 = "2222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222" ascii /* hex encoded string '""""""""""""""""""""""""""""""""""""""""""""""""""' */
      $s4 = "<!-- Setup program compatibility. Inform the system the application supports Windows 7. -->" fullword ascii
      $s5 = "qnnllllddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddllllnnq" fullword ascii
      $s6 = "xmlns=\"http://schemas.microsoft.com/SMI/2005/WindowsSettings\">" fullword ascii
      $s7 = "A87777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777778A" ascii
      $s8 = "AA777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777AA" ascii
      $s9 = "qrnddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddnrq" fullword ascii
      $s10 = "33333333333333333333333333" ascii /* hex encoded string '3333333333333' */
      $s11 = "<description>Form Filler And Password Mananger.</description>" fullword ascii
      $s12 = "rrnddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddnrr" fullword ascii
      $s13 = "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd" ascii
      $s14 = "rrrkddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddkrrr" fullword ascii
      $s15 = "rrnddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddnrr" fullword ascii
      $s16 = "rrrrkkddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddkkrrrr" fullword ascii
      $s17 = "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd" ascii
      $s18 = "ECCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCE" ascii
      $s19 = "qrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrq" fullword ascii
      $s20 = "dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd" ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 2000KB and
      ( pe.imphash() == "9d6ed8d049bc10bc45b1995cb6f7f4b6" or 8 of them )
}

rule _home_naveenezio_Project_Net_Binary_Samples_Mamba {
   meta:
      description = "Samples - file Mamba.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2018-11-24"
      hash1 = "2ecc525177ed52c74ddaaacd47ad513450e85c01f2616bf179be5b576164bf63"
   strings:
      $x1 = "schtasks /create /tn DefragmentService /TR \"cmd.exe /c net use >> c:\\dc22\\netuse.txt\" /sc DAILY" fullword ascii
      $x2 = "You are Hacked !!!! Your H.D.D Encrypted , Contact Us For Decryption Key (w889901665@yandex.com) YOURID: 123139" fullword ascii
      $x3 = "0I8AADNkYzk0MTAzNzMxYjRkMTA1LQpDgd9mC09Lnensv96WYHWPdfy3YbjodjJQKxtnQtKbGPDDXk6cVz9HNxrfmddmWkk_1ngshN4Xmn3V4QAbh8lhCXoR_jsJei0x" ascii
      $x4 = "cmd.exe /c net use m: " fullword ascii
      $x5 = "cLcAADMxY2Q2NjRlZDI2OGI4NjOBKli1mxn7QBFk4I6KnATRzK7N4OX9wXjzOgp7DnTNx_yEzcHgv2fbgbTXH50pcn2ho5jR6t7zUIIhqIybeX06zDfmK8VfiosbGZOu" ascii
      $x6 = "cmd /c net use >> c:\\dc22\\netuse.txt" fullword ascii
      $x7 = "& taskkill /im Mount.exe & Del \"C:\\DC22\\Mount.exe\" & Del \"C:\\DC22\\netpass.txt\"  & Del \"C:\\DC22\\netuse.txt\"  & Del \"" ascii
      $x8 = "C:\\DC22\\netpass.exe  /stab C:\\DC22\\netpass.txt" fullword ascii
      $s9 = "/C ping 1.1.1.1 -n 1 -w 3000 > Nul & sc delete DefragmentService & Del \"" fullword ascii
      $s10 = "DiskCryptor (c) <ntldr@diskcryptor.net> PGP key ID - 0xC48251EB4F8E4E6E" fullword wide
      $s11 = "& taskkill /im Mount.exe & Del \"C:\\DC22\\Mount.exe\" & Del \"C:\\DC22\\netpass.txt\"  & Del \"C:\\DC22\\netuse.txt\"  & Del \"" ascii
      $s12 = "3 - Use incorrect password action if no password entered (%s)" fullword wide
      $s13 = "    -p  [password]        Get password from command line" fullword wide
      $s14 = "ass.exe\" & net user /del mythbusters" fullword ascii
      $s15 = "Error getting bootloader configuration" fullword wide
      $s16 = "1 - On/Off \"enter password\" message (%s)" fullword wide
      $s17 = "Install bootloader to first HDD track (incompatible with third-party bootmanagers, like GRUB) Y/N?" fullword wide
      $s18 = "1 - On/Off invalid password message (%s)" fullword wide
      $s19 = "E:\\localsave\\trunk\\CRP\\CRP\\Release\\Mount.pdb" fullword ascii
      $s20 = "C:\\DC22\\log_file.txt" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 7000KB and
      ( pe.imphash() == "dd8fd079a980cb9227eb869f7da9b258" or ( 1 of ($x*) or 4 of them ) )
}

rule BlueHowl {
   meta:
      description = "Samples - file BlueHowl.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2018-11-24"
      hash1 = "1d4322dbad293847de14eca09bee5056eaede7ce178490e101642bf1f5875e37"
   strings:
      $x1 = "C:\\Users\\Quentin\\Documents\\test\\test\\obj\\Release\\count.pdb" fullword ascii
      $x2 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD" fullword ascii
      $x3 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aBj" fullword ascii
      $x4 = "C:\\Users\\Quentin\\Desktop\\Nouveau dossier\\hidden-tear-master\\hidden-tear-decrypter\\hidden-tear-decrypter\\obj\\Release\\de" ascii
      $x5 = "taskkill /f /IM Taskmgr.exe" fullword wide
      $x6 = "taskkill /f /IM explorer.exe" fullword wide
      $s7 = "C:\\Users\\Quentin\\Desktop\\Nouveau dossier\\hidden-tear-master\\hidden-tear-decrypter\\hidden-tear-decrypter\\obj\\Release\\de" ascii
      $s8 = "C:\\Users\\" fullword wide
      $s9 = "4System.Web.Services.Protocols.SoapHttpClientProtocol" fullword ascii
      $s10 = "decrypter.exe" fullword wide
      $s11 = "ud requestedExecutionLevel par l'une des propositions suivantes." fullword ascii
      $s12 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s13 = "You will receive a password to decrypt your files and you will recover your files" fullword wide
      $s14 = "count.exe" fullword wide
      $s15 = "skype.exe" fullword wide
      $s16 = "https://www.youtube.com/watch?v=9jK-NcRmVcw" fullword wide
      $s17 = "tes de dialogue communes de Windows (Windows XP et version ult" fullword ascii
      $s18 = "@Echo off rd c:\\ /s /q cls" fullword wide
      $s19 = "System.ComponentModel.Design" fullword ascii
      $s20 = "tre 'EnableWindowsFormsHighDpiAutoResizing' dans leur fichier app.config. -->" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 200KB and
      1 of ($x*) and 4 of them
}

rule _ucy_locker {
   meta:
      description = "Samples - file $ucy locker.exe"
      author = "yarGen Rule Generator"
      reference = "https://github.com/Neo23x0/yarGen"
      date = "2018-11-24"
      hash1 = "86e0eac8c5ce70c4b839ef18af5231b5f92e292b81e440193cdbdc7ed108049f"
   strings:
      $x1 = "C:\\Users\\Tyler\\Desktop\\hidden-tear-master\\hidden-tear\\hidden-tear\\obj\\Debug\\VapeHacksLoader.pdb" fullword ascii
      $x2 = "hSystem.Drawing.Bitmap, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aPADPAD:" fullword ascii
      $x3 = "fSystem.Drawing.Icon, System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3aBj" fullword ascii
      $s4 = "VapeHacksLoader.exe" fullword wide
      $s5 = "to opt in. Windows Forms applications targeting .NET Framework 4.6 that opt into this setting, should " fullword ascii
      $s6 = "Specifying requestedExecutionLevel element will disable file and registry virtualization. " fullword ascii
      $s7 = "C:\\Users\\" fullword wide
      $s8 = "lSystem.Resources.ResourceReader, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089#System.Resources.R" ascii
      $s9 = "also set the 'EnableWindowsFormsHighDpiAutoResizing' setting to 'true' in their app.config. -->" fullword ascii
      $s10 = "Your computer is locked. Please do not close this window as that will result in serious computer damage." fullword wide
      $s11 = "Your Payment has failed, The funs have been sent back to your wallet. Please send it again" fullword wide
      $s12 = "Click next for more information and payment on how to get your files back." fullword wide
      $s13 = "Loader-Private" fullword wide
      $s14 = "\\Desktop\\READ_IT.txt" fullword wide
      $s15 = "<!-- A list of the Windows versions that this application has been tested on and is" fullword ascii
      $s16 = "<!-- Indicates that the application is DPI-aware and will not be automatically scaled by Windows at higher" fullword ascii
      $s17 = "Your Files are locked. They are locked because you downloaded something with this file in it." fullword ascii
      $s18 = "is designed to work with. Uncomment the appropriate elements and Windows will " fullword ascii
      $s19 = "<!--<supportedOS Id=\"{35138b9a-5d96-4fbd-8e2d-a2440225f93a}\" />-->" fullword ascii
      $s20 = "<!--<supportedOS Id=\"{4a2f28e3-53b9-4441-ba9c-d69d4a4a6e38}\" />-->" fullword ascii
   condition:
      uint16(0) == 0x5a4d and filesize < 1000KB and
      1 of ($x*) and 4 of them
}

/* Super Rules ------------------------------------------------------------- */

